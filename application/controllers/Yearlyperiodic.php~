<?php

	class Yearlyperiodic extends CI_Controller 
	{
			public function __construct(){
				parent::__construct();
					$this->load->helper('url'); 
					$this->load->library('session');
					$this->load->model('Yearly_periodic_model');
					$this->load->library("pagination");
					$this->load->library(array('session', 'form_validation'));
		}
		
		public function index($year=''){
			if($this->session->user == 'logged_in'){
			if($year==''){
		    $year=date('20y');
			}
		    $data['year']=  $year;
			$data['fetch'] = $this->Yearly_periodic_model->getyear($year);				
			$this->load->view('yearly-periodic',$data); 
			}else{
				$this->load->view("login");
			}
		
		}
		
		
		
		public function view(){
			if($this->session->user == 'logged_in'){
			$this->load->view("yearly-periodic-view"); 
			}else{
				$this->load->view("login");
			}	
		}
		
		public function add_data(){
			$record_id =$this->uri->segment(3); 
			
			$data = array();
			$data[0] = array(
			'yearly_periodic_start_date'=>$this->input->post('start_date'),
			'yearly_periodic_end_date'=>$this->input->post('end_date'),
			'yearly_periodic_task_name'=>$this->input->post('task'),
			'yearly_periodic_remark'=>$this->input->post('remark'),
			'yearly_periodic_status'=>$this->input->post('status'),
			'yearly_periodic_month'=>$this->input->post('month')
			);
			$data[1] = array(
			'yearly_periodic_delegates_name'=>$this->input->post('delegate_to'),
			'yearly_periodic_delegates_email'=>$this->input->post('email'),
			);
			$data[2] = array(
			'monthly_periodic_status_date'=>$this->input->post('date'),
			'monthly_periodic_status_note'=>$this->input->post('note'),

			);
			if($this->uri->segment(3)){
			$this->Yearly_periodic_model->updatetask($data , $record_id);
			redirect('yearlyperiodic/');
			}
			else{
			$this->Yearly_periodic_model->insertmonthly($data);
			redirect('yearlyperiodic');
			}

		}
		 
	}
?>	
		